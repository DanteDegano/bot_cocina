<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChefBot - Asistente de Cocina</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 20px;
        }



        /* Contenedor principal */
        .main-container {
            max-width: 1200px;
            width: 100%;
            display: flex;
            gap: 40px;
            align-items: flex-start;
            justify-content: center;
        }

        /* Panel del chef */
        .chef-panel {
            min-width: 300px;
        }

        .chef-avatar {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 3px solid #FFD700;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Ccircle cx='100' cy='100' r='95' fill='white'/%3E%3C!-- Chef Hat --%3E%3Cpath d='M60 80 Q60 60 80 60 Q90 45 100 45 Q110 45 120 60 Q140 60 140 80 L140 85 Q140 90 135 90 L65 90 Q60 90 60 85 Z' fill='white' stroke='%23333' stroke-width='2'/%3E%3Cpath d='M65 85 L135 85 L130 100 L70 100 Z' fill='white' stroke='%23333' stroke-width='2'/%3E%3C!-- Face --%3E%3Ccircle cx='100' cy='115' r='25' fill='%23FDBCB4'/%3E%3C!-- Eyes --%3E%3Ccircle cx='92' cy='108' r='2' fill='%23333'/%3E%3Ccircle cx='108' cy='108' r='2' fill='%23333'/%3E%3C!-- Nose --%3E%3Cpath d='M100 112 L102 115 L98 115 Z' fill='%23F4A582'/%3E%3C!-- Mouth --%3E%3Cpath d='M95 120 Q100 125 105 120' stroke='%23333' stroke-width='1.5' fill='none'/%3E%3C!-- Chef Coat --%3E%3Cpath d='M75 135 Q75 130 80 130 L120 130 Q125 130 125 135 L125 170 Q125 175 120 175 L80 175 Q75 175 75 170 Z' fill='white' stroke='%23333' stroke-width='2'/%3E%3C!-- Buttons --%3E%3Ccircle cx='100' cy='145' r='2' fill='%23333'/%3E%3Ccircle cx='100' cy='155' r='2' fill='%23333'/%3E%3Ccircle cx='100' cy='165' r='2' fill='%23333'/%3E%3C!-- Red Necktie --%3E%3Cpath d='M95 130 Q100 125 105 130 L103 140 Q100 145 97 140 Z' fill='%23e74c3c'/%3E%3C!-- Utensils --%3E%3Cpath d='M70 140 L75 135 L77 137 L72 142 Z' fill='%23666'/%3E%3Cpath d='M128 137 L123 142 L125 144 L130 139 Z' fill='%23666'/%3E%3Cpath d='M125 135 Q130 130 135 135 Q130 140 125 135' fill='%23666'/%3E%3C!-- Steam --%3E%3Cpath d='M140 125 Q142 120 144 125 Q146 120 148 125' stroke='%23ccc' stroke-width='1' fill='none'/%3E%3Cpath d='M145 130 Q147 125 149 130 Q151 125 153 130' stroke='%23ccc' stroke-width='1' fill='none'/%3E%3C/svg%3E");
            background-size: 80%;
            background-repeat: no-repeat;
            background-position: center;
        }

        .chef-info h1 {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .chef-description {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .chef-question {
            color: #333;
            font-weight: 500;
            margin-bottom: 20px;
        }

        /* Chat container */
        .chat-area {
            flex: 1;
            max-width: 800px;
        }

        .chat-container {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        /* Estilos de mensajes tipo tarjeta */
        .message-card {
            margin-bottom: 20px;
            animation: slideIn 0.3s ease-out;
        }

        .message-card.user {
            display: flex;
            justify-content: flex-end;
        }

        .message-card.bot {
            display: flex;
            justify-content: flex-start;
        }

        .message-content {
            max-width: 80%;
            padding: 20px;
            border-radius: 20px;
            position: relative;
        }

        .message-card.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-card.bot .message-content {
            background: #FFD700;
            color: #333;
            border-bottom-left-radius: 5px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }



        /* Input area */
        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-container {
            flex: 1;
            position: relative;
        }

        .chat-input {
            width: 100%;
            min-height: 50px;
            padding: 15px 50px 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            resize: none;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #FFD700;
        }

        .send-button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-54%);
            width: 40px;
            height: 40px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            color: #666;
            font-size: 18px;
            font-weight: bold;
        }

        .send-button:hover {
            color: #333;
        }

        .disclaimer {
            text-align: center;
            padding: 15px;
            color: #999;
            font-size: 12px;
            background: #f8f9fa;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                align-items: flex-start;
                padding-top: 20px;
            }
            
            .main-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            
            .chef-panel {
                min-width: auto;
                text-align: center;
                width: 100%;
                max-width: 400px;
            }
            
            .chat-container {
                height: 500px;
                width: 100%;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Chef Panel -->
        <div class="chef-panel">
            <div class="chef-avatar"><!-- Imagen logo chefbot--></div>
            <div class="chef-info">
                <h1>ChefBot</h1>
                <p class="chef-description">
                    Te ayudo a encontrar las mejores recetas de cocina.
                </p>
                <p class="chef-question">
                    Â¿QuÃ© querÃ©s cocinar hoy?
                </p>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <!-- Los mensajes se agregarÃ¡n aquÃ­ dinÃ¡micamente -->
                </div>
                
                <div class="chat-input-area">
                    <div class="input-container">
                        <textarea 
                            class="chat-input" 
                            id="chat-input"
                            placeholder="PregÃºntame sobre recetas, tÃ©cnicas de cocina o ingredientes..."
                            rows="1"></textarea>
                        <button class="send-button" id="send-button">
                            âž¤
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="disclaimer">
                Respuestas generadas por inteligencia artificial.<br>
                Este chatbot estÃ¡ en etapa experimental y eventualmente puede presentar imprecisiones.
            </div>
        </div>
    </div>

    <!-- Script para manejar el chat -->
    <script type="module">
        import geminiService from 'http://localhost:5173/src/services/geminiService.js';
        
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        
        let conversationHistory = [];

        // Mensaje de bienvenida
        addMessage('Â¡Hola! ðŸ‘‹ Soy ChefBot, tu asistente personal de cocina. Puedo ayudarte con recetas, tÃ©cnicas culinarias, sustituciones de ingredientes y consejos de cocina. Â¿En quÃ© puedo ayudarte hoy?', 'bot');

        function addMessage(content, type) {
            const messageCard = document.createElement('div');
            messageCard.className = `message-card ${type}`;
            
            messageCard.innerHTML = `
                <div class="message-content">
                    ${content}
                </div>
            `;
            
            chatMessages.appendChild(messageCard);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addLoadingMessage() {
            const messageCard = document.createElement('div');
            messageCard.className = 'message-card bot';
            messageCard.id = 'loading-message';
            messageCard.innerHTML = `
                <div class="message-content">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        ChefBot estÃ¡ cocinando una respuesta
                        <div style="display: flex; gap: 3px;">
                            <div style="width: 6px; height: 6px; background: #333; border-radius: 50%; animation: bounce 1.4s ease-in-out infinite both;"></div>
                            <div style="width: 6px; height: 6px; background: #333; border-radius: 50%; animation: bounce 1.4s ease-in-out infinite both; animation-delay: -0.16s;"></div>
                            <div style="width: 6px; height: 6px; background: #333; border-radius: 50%; animation: bounce 1.4s ease-in-out infinite both; animation-delay: -0.32s;"></div>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageCard);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeLoadingMessage() {
            const loadingMessage = document.getElementById('loading-message');
            if (loadingMessage) {
                loadingMessage.remove();
            }
        }

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            // Agregar mensaje del usuario
            addMessage(message, 'user');
            chatInput.value = '';

            // Agregar mensaje de carga
            addLoadingMessage();

            try {
                // Enviar a Gemini
                const response = await geminiService.sendMessage(message, conversationHistory);
                
                // Remover mensaje de carga
                removeLoadingMessage();
                
                // Agregar respuesta del bot
                addMessage(response, 'bot');
                
                // Actualizar historial
                conversationHistory.push(
                    { role: 'user', content: message },
                    { role: 'bot', content: response }
                );
                
                // Mantener solo los Ãºltimos 6 mensajes en el historial
                if (conversationHistory.length > 6) {
                    conversationHistory = conversationHistory.slice(-6);
                }
                
            } catch (error) {
                removeLoadingMessage();
                addMessage('Lo siento, no pude procesar tu mensaje. Por favor, intenta de nuevo.', 'bot');
                console.error('Error:', error);
            }
        }

        // Event listeners
        sendButton.addEventListener('click', sendMessage);
        
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Auto-resize textarea
        chatInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Estilo para la animaciÃ³n de carga
        const style = document.createElement('style');
        style.textContent = `
            @keyframes bounce {
                0%, 80%, 100% {
                    transform: scale(0);
                }
                40% {
                    transform: scale(1);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>